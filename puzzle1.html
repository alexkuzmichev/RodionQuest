<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ó–∞–≥–∞–¥–∫–∞ 1 ‚Äî –í–æ—Ä–¥–ª–µ (—Ä—É—Å.)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-yellow-100 to-green-200 flex items-center justify-center p-4 text-slate-900">
  <div class="w-full max-w-md">
    <div class="bg-white rounded-2xl shadow-xl p-5">
      <h1 class="text-2xl font-bold text-center mb-1">üü© –í–æ—Ä–¥–ª–µ (—Ä—É—Å—Å–∫–∏–π)</h1>
      <p class="text-center text-sm text-slate-600 mb-4">–£–≥–∞–¥–∞–π—Ç–µ —Å–ª–æ–≤–æ –∏–∑ 5 –±—É–∫–≤ –∑–∞ 6 –ø–æ–ø—ã—Ç–æ–∫</p>

      <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
      <div id="board" class="grid grid-rows-6 gap-2 mb-4"></div>

      <!-- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ -->
      <div id="keyboard" class="select-none"></div>

      <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –¥–∞–ª—å—à–µ (—Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ) -->
      <div class="mt-4 flex justify-center">
        <a id="nextBtn" href="puzzle2.html"
           class="px-4 py-2 rounded-xl bg-slate-300 text-white font-semibold pointer-events-none opacity-50">
          –î–∞–ª–µ–µ ‚Üí
        </a>
      </div>

      <!-- –¢–µ—Å—Ç–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (–ø–æ –ø—Ä–æ—Å—å–±–µ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã) -->
      <div class="mt-2 text-center text-xs text-slate-500">
        <a href="puzzle2.html" class="underline">–¢–µ—Å—Ç: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</a>
      </div>
    </div>
  </div>

<script>
// ====== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ======
const ROWS = 6;
const COLS = 5;
// –ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞, 5 –±—É–∫–≤)
const SECRET = '–°–ê–ü–û–ì';

// ====== DOM ======
const board = document.getElementById('board');
const keyboard = document.getElementById('keyboard');
const nextBtn = document.getElementById('nextBtn');

// ====== –£—Ç–∏–ª–∏—Ç—ã ======
function makeTile() {
  const d = document.createElement('div');
  d.className = 'w-14 h-14 border border-slate-300 rounded-xl flex items-center justify-center text-2xl font-bold bg-white';
  d.textContent = '';
  return d;
}

function createBoard() {
  for (let r = 0; r < ROWS; r++) {
    const row = document.createElement('div');
    row.className = 'grid grid-cols-5 gap-2';
    for (let c = 0; c < COLS; c++) row.appendChild(makeTile());
    board.appendChild(row);
  }
}
function rowTiles(r){ return board.children[r].children; }
function setTile(r,c,ch){ rowTiles(r)[c].textContent = ch || ''; }
function colorTile(el, status){
  if (status === 'correct') el.className = 'w-14 h-14 rounded-xl flex items-center justify-center text-2xl font-bold text-white bg-green-500';
  else if (status === 'present') el.className = 'w-14 h-14 rounded-xl flex items-center justify-center text-2xl font-bold text-white bg-yellow-500';
  else el.className = 'w-14 h-14 rounded-xl flex items-center justify-center text-2xl font-bold text-white bg-slate-400';
}

// ====== –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (—Ä—É—Å—Å–∫–∞—è) ======
const KEYS = [
  '–ô–¶–£–ö–ï–ù–ì–®–©–ó–•–™'.split(''),
  '–§–´–í–ê–ü–†–û–õ–î–ñ–≠'.split(''),
  ['–í–≤–æ–¥', ...'–Ø–ß–°–ú–ò–¢–¨–ë–Æ'.split(''), '‚å´']
];
function createKeyboard(){
  KEYS.forEach(row=>{
    const line = document.createElement('div');
    line.className = 'flex justify-center gap-1 mb-1';
    row.forEach(k=>{
      const b = document.createElement('button');
      b.textContent = k;
      b.dataset.key = k;
      b.className = 'px-3 py-2 rounded-lg bg-slate-200 hover:bg-slate-300 text-sm font-semibold';
      if (k === '–í–≤–æ–¥') b.className += ' basis-20';
      if (k === '‚å´') b.className += ' basis-16';
      b.addEventListener('click', ()=>handleKey(k));
      line.appendChild(b);
    });
    keyboard.appendChild(line);
  });
}
function colorKeyboard(letter, status){
  const btn = keyboard.querySelector(`[data-key="${letter}"]`);
  if (!btn) return;
  const pr = {'':0,'absent':1,'present':2,'correct':3};
  const cur = btn.dataset.status || '';
  if (pr[status] <= pr[cur]) return;
  btn.dataset.status = status;
  if (status === 'correct') btn.className = 'px-3 py-2 rounded-lg bg-green-500 text-white text-sm font-semibold';
  else if (status === 'present') btn.className = 'px-3 py-2 rounded-lg bg-yellow-500 text-white text-sm font-semibold';
  else if (status === 'absent') btn.className = 'px-3 py-2 rounded-lg bg-slate-500 text-white text-sm font-semibold';
}

// ====== –°–æ—Å—Ç–æ—è–Ω–∏–µ ======
let currentRow = 0;
let currentCol = 0;
let locked = false;

createBoard();
createKeyboard();

// ====== –í–≤–æ–¥ ======
function handleKey(k){
  if (locked) return;
  if (/^[–ê-–Ø–Å]$/.test(k)) {
    if (currentCol < COLS) { setTile(currentRow, currentCol, k); currentCol++; }
  } else if (k === '‚å´' || k === 'Backspace') {
    if (currentCol > 0) { currentCol--; setTile(currentRow, currentCol, ''); }
  } else if (k === '–í–≤–æ–¥' || k === 'Enter') {
    if (currentCol !== COLS) return shakeRow(currentRow);
    submitRow();
  }
}

window.addEventListener('keydown', e=>{
  let key = e.key;
  // –ü—Ä–∏–≤–æ–¥–∏–º –∫ –≤–µ—Ä—Ö–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ, –µ—Å–ª–∏ —ç—Ç–æ –æ–¥–Ω–∞ –±—É–∫–≤–∞
  if (key.length === 1) {
    key = key.toUpperCase();
    if (/^[–ê-–Ø–Å]$/.test(key)) { handleKey(key); return; }
  }
  if (key === 'Enter') handleKey('–í–≤–æ–¥');
  else if (key === 'Backspace') handleKey('Backspace');
});

function getGuess(r){
  return Array.from(rowTiles(r)).map(t=>t.textContent || '').join('');
}

function evaluate(guess, secret){
  const res = Array(COLS).fill('absent');
  const s = secret.split('');
  const g = guess.split('');

  // —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
  for (let i=0;i<COLS;i++){
    if (g[i] === s[i]) { res[i]='correct'; s[i]=null; g[i]=null; }
  }
  // –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ
  for (let i=0;i<COLS;i++){
    if (g[i]) {
      const idx = s.indexOf(g[i]);
      if (idx !== -1){ res[i]='present'; s[idx]=null; }
    }
  }
  return res;
}

function submitRow(){
  const guess = getGuess(currentRow);
  const statuses = evaluate(guess, SECRET);

  // —Ä–∞—Å–∫—Ä–∞—Å–∏—Ç—å
  const tiles = rowTiles(currentRow);
  for (let i=0;i<COLS;i++){
    const st = statuses[i];
    colorTile(tiles[i], st);
    const letter = guess[i];
    colorKeyboard(letter, st === 'correct' ? 'correct' : st === 'present' ? 'present' : 'absent');
  }

  if (guess === SECRET){
    locked = true;
    toast(`–í–µ—Ä–Ω–æ! –°–ª–æ–≤–æ ${SECRET} üéâ`);
    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
    nextBtn.className = 'px-4 py-2 rounded-xl bg-green-600 text-white font-semibold';
    nextBtn.classList.remove('pointer-events-none','opacity-50');
    return;
  }

  currentRow++; currentCol = 0;
  if (currentRow >= ROWS){
    locked = true;
    toast(`–ù–µ –≤—ã—à–ª–æ. –ë—ã–ª–æ —Å–ª–æ–≤–æ: ${SECRET} üòÖ`);
  }
}

// ====== UI ======
function shakeRow(r){
  const row = board.children[r];
  row.classList.add('animate-[shake_0.3s_ease-in-out]');
  setTimeout(()=>row.classList.remove('animate-[shake_0.3s_ease-in-out]'),300);
}
function toast(msg){
  const t = document.createElement('div');
  t.textContent = msg;
  t.className = 'fixed left-1/2 -translate-x-1/2 top-5 bg-slate-900 text-white px-4 py-2 rounded-xl shadow-lg z-50';
  document.body.appendChild(t);
  setTimeout(()=>t.remove(), 2500);
}
</script>

<style>
@keyframes shake { 10%,90%{transform:translateX(-1px)} 20%,80%{transform:translateX(2px)} 30%,50%,70%{transform:translateX(-4px)} 40%,60%{transform:translateX(4px)} }
</style>
</body>
</html>
