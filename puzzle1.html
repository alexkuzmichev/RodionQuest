<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö—É–¥–∞ –ø—Ä–æ–ø–∞–ª–∏ —Å–∞–ø–æ–≥–∏?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --tile: clamp(44px, 9.5vw, 62px); }
    @keyframes shake { 10%,90%{transform:translateX(-1px)} 20%,80%{transform:translateX(2px)} 30%,50%,70%{transform:translateX(-4px)} 40%,60%{transform:translateX(4px)} }
    .tile {
      width: var(--tile); height: var(--tile);
      border-radius: 0.75rem; display:flex; align-items:center; justify-content:center;
      font-weight: 800; font-size: clamp(18px, 5vw, 28px); background:#fff; border:1px solid rgb(203 213 225);
    }
    .tile--correct { background:#22c55e; color:#fff; border:none; }
    .tile--present { background:#eab308; color:#fff; border:none; }
    .tile--absent  { background:#64748b; color:#fff; border:none; }
    .kbd { flex:1 1 0%; min-width:0; padding:.6rem .5rem; border-radius:.6rem; background:#e2e8f0; font-weight:600; }
    .kbd:hover { background:#cbd5e1; }
    .kbd--correct { background:#22c55e; color:#fff; }
    .kbd--present { background:#eab308; color:#fff; }
    .kbd--absent  { background:#64748b; color:#fff; }
    .kbd--action { background:#3b82f6; color:#fff; font-weight:700; }
    .kbd--action:hover { background:#2563eb; }
    .kbd--action.entered { background:#059669; }
    .kbd--action.delete { background:#ef4444; }
    .kbd--action.delete:hover { background:#dc2626; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-yellow-100 to-green-200 flex items-center justify-center p-4 text-slate-900">
  <div class="w-full max-w-md">
    <div class="bg-white rounded-2xl shadow-xl p-4 sm:p-5">
      <h1 class="text-2xl font-bold text-center mb-1">–ö—É–¥–∞ –ø—Ä–æ–ø–∞–ª–∏ —Å–∞–ø–æ–≥–∏?</h1>
      <p class="text-center text-sm text-slate-600 mb-4">–£–≥–∞–¥–∞–π—Ç–µ —Å–ª–æ–≤–æ –∏–∑ 5 –±—É–∫–≤ –∑–∞ 6 –ø–æ–ø—ã—Ç–æ–∫</p>

      <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
      <div id="board" class="grid grid-rows-6 gap-2 mb-4 justify-items-center"></div>

      <!-- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî flex —Å —Ä–∞–≤–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º -->
      <div id="keyboard" class="select-none space-y-2 -mx-4 sm:-mx-5 px-4 sm:px-5"></div>

      <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –¥–∞–ª—å—à–µ (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ) -->
      <div class="mt-4 flex justify-center">
        <a id="nextBtn" href="puzzle2.html"
           class="px-4 py-2 rounded-xl bg-slate-300 text-white font-semibold pointer-events-none opacity-50">
          –°–∞–ø–æ–≥–∏ –Ω–∞—à–ª–∏—Å—å
        </a>
      </div>

      <!-- –¢–µ—Å—Ç–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
      <div class="mt-2 text-center text-xs text-slate-500">
        <a href="puzzle2.html" class="underline">–¢–µ—Å—Ç: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</a>
      </div>
    </div>
  </div>

<script>
// ====== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ======
const ROWS = 6, COLS = 5;
const SECRET = '–§–ï–†–ú–ê'; // –∑–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞, 5 –±—É–∫–≤)

// ====== DOM ======
const board = document.getElementById('board');
const keyboard = document.getElementById('keyboard');
const nextBtn = document.getElementById('nextBtn');

// ====== –ü–æ–ª–µ ======
function makeTile() {
  const d = document.createElement('div');
  d.className = 'tile';
  d.textContent = '';
  return d;
}
function createBoard() {
  for (let r = 0; r < ROWS; r++) {
    const row = document.createElement('div');
    row.className = 'grid grid-cols-5 gap-2';
    for (let c = 0; c < COLS; c++) row.appendChild(makeTile());
    board.appendChild(row);
  }
}
function rowTiles(r){ return board.children[r].children; }
function setTile(r,c,ch){ rowTiles(r)[c].textContent = ch || ''; }
function colorTile(el, status){
  el.classList.remove('tile--correct','tile--present','tile--absent');
  if (status === 'correct') el.classList.add('tile--correct');
  else if (status === 'present') el.classList.add('tile--present');
  else el.classList.add('tile--absent');
}

// ====== –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (—Ä—É—Å—Å–∫–∞—è) ======
const KEYS = [
  '–ô–¶–£–ö–ï–ù–ì–®–©–ó–•–™'.split(''),     // 12
  '–§–´–í–ê–ü–†–û–õ–î–ñ–≠'.split(''),      // 11
  ['–í–≤–æ–¥', ...'–Ø–ß–°–ú–ò–¢–¨–ë–Æ'.split(''), '‚å´'] // 1 + 9 + 1 = 11
];

function createKeyboard(){
  KEYS.forEach(row=>{
    const line = document.createElement('div');
    line.className = 'flex gap-1';
    row.forEach(k=>{
      const b = document.createElement('button');
      b.textContent = k;
      b.dataset.key = k;
      b.className = 'kbd text-sm';
      if (k === '–í–≤–æ–¥') {
        b.style.flex = '1.3 1 0%';     // Enter –Ω–µ–º–Ω–æ–≥–æ —à–∏—Ä–µ
        b.classList.add('kbd--action');
      } else if (k === '‚å´') {
        b.style.flex = '1.1 1 0%';     // Backspace —Å–ª–µ–≥–∫–∞ —à–∏—Ä–µ
        b.classList.add('kbd--action', 'delete');
      }
      b.addEventListener('click', ()=>handleKey(k));
      line.appendChild(b);
    });
    keyboard.appendChild(line);
  });
}
function colorKeyboard(letter, status){
  const btn = keyboard.querySelector(`[data-key="${letter}"]`);
  if (!btn) return;
  // –ù–µ –∏–∑–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π (–í–≤–æ–¥ –∏ ‚å´)
  if (btn.classList.contains('kbd--action')) return;
  const pr = {'':0,'absent':1,'present':2,'correct':3};
  const cur = btn.dataset.status || '';
  if (pr[status] <= pr[cur]) return;
  btn.dataset.status = status;
  btn.classList.remove('kbd--correct','kbd--present','kbd--absent');
  if (status === 'correct') btn.classList.add('kbd--correct');
  else if (status === 'present') btn.classList.add('kbd--present');
  else if (status === 'absent')  btn.classList.add('kbd--absent');
}

// ====== –°–æ—Å—Ç–æ—è–Ω–∏–µ ======
let currentRow = 0, currentCol = 0, locked = false;

createBoard();
createKeyboard();

// ====== –í–≤–æ–¥ ======
function handleKey(k){
  if (locked) return;
  if (/^[–ê-–Ø–Å]$/.test(k)) {
    if (currentCol < COLS) { setTile(currentRow, currentCol, k); currentCol++; }
  } else if (k === '‚å´' || k === 'Backspace') {
    if (currentCol > 0) { currentCol--; setTile(currentRow, currentCol, ''); }
  } else if (k === '–í–≤–æ–¥' || k === 'Enter') {
    if (currentCol !== COLS) return shakeRow(currentRow);
    submitRow();
  }
}

window.addEventListener('keydown', e=>{
  let key = e.key;
  if (key.length === 1) {
    key = key.toUpperCase();
    if (/^[–ê-–Ø–Å]$/.test(key)) { handleKey(key); return; }
  }
  if (key === 'Enter') handleKey('–í–≤–æ–¥');
  else if (key === 'Backspace') handleKey('Backspace');
});

function getGuess(r){
  return Array.from(rowTiles(r)).map(t=>t.textContent || '').join('');
}

function evaluate(guess, secret){
  const res = Array(COLS).fill('absent');
  const s = secret.split('');
  const g = guess.split('');
  for (let i=0;i<COLS;i++){
    if (g[i] === s[i]) { res[i]='correct'; s[i]=null; g[i]=null; }
  }
  for (let i=0;i<COLS;i++){
    if (g[i]) {
      const idx = s.indexOf(g[i]);
      if (idx !== -1){ res[i]='present'; s[idx]=null; }
    }
  }
  return res;
}

function submitRow(){
  const guess = getGuess(currentRow);
  const statuses = evaluate(guess, SECRET);

  const tiles = rowTiles(currentRow);
  for (let i=0;i<COLS;i++){
    const st = statuses[i];
    colorTile(tiles[i], st);
    const letter = guess[i];
    colorKeyboard(letter, st === 'correct' ? 'correct' : st === 'present' ? 'present' : 'absent');
  }

  if (guess === SECRET){
    locked = true;
    toast(`–í–µ—Ä–Ω–æ! –°–ª–æ–≤–æ ${SECRET} üéâ`);
    nextBtn.className = 'px-4 py-2 rounded-xl bg-green-600 text-white font-semibold';
    nextBtn.classList.remove('pointer-events-none','opacity-50');
    return;
  }

  currentRow++; currentCol = 0;
  if (currentRow >= ROWS){
    locked = true;
    toast(`–ù–µ –≤—ã—à–ª–æ. –ë—ã–ª–æ —Å–ª–æ–≤–æ: ${SECRET} üòÖ`);
  }
}

// ====== UI ======
function shakeRow(r){
  const row = board.children[r];
  row.classList.add('animate-[shake_0.3s_ease-in-out]');
  setTimeout(()=>row.classList.remove('animate-[shake_0.3s_ease-in-out]'),300);
}
function toast(msg){
  const t = document.createElement('div');
  t.textContent = msg;
  t.className = 'fixed left-1/2 -translate-x-1/2 top-5 bg-slate-900 text-white px-4 py-2 rounded-xl shadow-lg z-50';
  document.body.appendChild(t);
  setTimeout(()=>t.remove(), 2500);
}
</script>
</body>
</html>
